<UserControl x:Class="StructuredLogViewer.Controls.LLMChatControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="400"
             Background="{DynamicResource Theme_Background}">
  <DockPanel>
    <!-- Header -->
    <Border DockPanel.Dock="Top" 
            Background="{DynamicResource Theme_InfoBarBackground}"
            BorderBrush="Gray"
            BorderThickness="0,0,0,1"
            Padding="8,4">
      <DockPanel>
        <Button x:Name="clearButton" 
                DockPanel.Dock="Right"
                Content="Clear"
                Padding="8,2"
                Margin="4,0,0,0"
                Click="ClearButton_Click"
                ToolTip="Clear conversation" />
        <TextBlock Text="LLM Chat" 
                   FontWeight="Bold" 
                   VerticalAlignment="Center"
                   Foreground="{DynamicResource Theme_Foreground}"/>
      </DockPanel>
    </Border>

    <!-- Status Bar -->
    <Border x:Name="statusBar" 
            DockPanel.Dock="Top"
            Background="{DynamicResource Theme_InfoBarBackground}"
            BorderBrush="Gray"
            BorderThickness="0,0,0,1"
            Padding="8,4"
            Visibility="Collapsed">
      <TextBlock x:Name="statusText" 
                 TextWrapping="Wrap"
                 Foreground="{DynamicResource Theme_Foreground}"/>
    </Border>

    <!-- Input Area -->
    <Border DockPanel.Dock="Bottom" 
            Background="{DynamicResource Theme_Background}"
            BorderBrush="Gray"
            BorderThickness="0,1,0,0"
            Padding="8">
      <DockPanel>
        <Button x:Name="sendButton" 
                DockPanel.Dock="Right"
                Content="Send"
                Padding="12,4"
                Margin="8,0,0,0"
                Click="SendButton_Click"
                IsEnabled="True"
                MinWidth="60" />
        <TextBox x:Name="inputTextBox"
                 TextWrapping="Wrap"
                 AcceptsReturn="True"
                 MaxHeight="100"
                 VerticalScrollBarVisibility="Auto"
                 Padding="4"
                 KeyDown="InputTextBox_KeyDown"
                 Background="{DynamicResource Theme_Background}"
                 Foreground="{DynamicResource Theme_Foreground}"
                 ToolTip="Type your question and press Enter or click Send (Shift+Enter for new line)"/>
      </DockPanel>
    </Border>

    <!-- Chat Messages Area -->
    <ScrollViewer x:Name="chatScrollViewer"
                  VerticalScrollBarVisibility="Auto"
                  Padding="8">
      <ItemsControl x:Name="messagesPanel">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <Border Margin="0,0,0,8"
                    Padding="8"
                    CornerRadius="4"
                    Background="{Binding RoleBackground}"
                    BorderBrush="{Binding RoleBorder}"
                    BorderThickness="1">
              <DockPanel>
                <TextBlock DockPanel.Dock="Top"
                           Text="{Binding Role}"
                           FontWeight="Bold"
                           Foreground="{Binding RoleForeground}"
                           Margin="0,0,0,4"/>
                <TextBlock Text="{Binding Content}"
                           TextWrapping="Wrap"
                           Foreground="{Binding ContentForeground}"/>
              </DockPanel>
            </Border>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </ScrollViewer>
  </DockPanel>
</UserControl>
